{% extends "layout.html" %}

{% block subtitle %}
{{revision.page.title}}
{% endblock %}

{% block bodyclass %}page-{{revision.page.slug}}{% endblock %}

{% block content %}

{% if revision.page.slug != settings.INDEX_PAGE %}
<h1>
  {{revision.page.title}}
</h1>
{% endif %}

{% if redirectFrom %}
<p><small>Redirected from <a
    href="{{url_for('edit', slug=redirectFrom)}}">{{redirectFrom}}</a></small>
{% endif %}

{% if not revision.is_latest %}
<ul class="pagination">
  <li class="arrow"><a href="{{url_for('view', revision=revision.prev.id)}}">&laquo;</a></li>
  <li class="current">Revision {{revision.id}}</li>
  <li class="arrow"><a href="{{url_for('view', revision=revision.next.id)}}">&raquo;</a></li>
</ul>

<div class="row">
  <div class="large-12 columns">
    <h2>Diff between {{revision.prev.id}} (old) and {{revision.id}} (newer)</h2>
    <div class="diff">
{% for line in revision.diffToPrev %}<div class="{{line.type}}">{{ line.contents }}</div>
{% endfor %}
    </div>
  </div>
</div>
{% endif %}

<p>{{revision.html | safe}}

{% if revision.page.slug != settings.INDEX_PAGE %}
<h2>Attachments</h2>
<ul class="attachments">
  {% for attachment in revision.page.attachments %}
  <li><a data-title="{{attachment.filename}}" data-lightbox="page-attachments" href="{{url_for('get_attachment', slug=revision.page.slug, fileslug=attachment.slug)}}">{{attachment.filename}}</a></li>
  {% endfor %}
</ul>

<ul class="softlinks">
{% for softlink in revision.page.softlinks_out %}
<li><a href="{{url_for('view', slug=softlink.dest.slug)}}">{{softlink.dest.title}}</a></li>
{% endfor %}
<br style="clear:both">
</ul>
{% endif %}
{% endblock %}
